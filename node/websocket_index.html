<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weboscoket MQTT</title>
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>

    <script>

        const host = 'localhost'

        console.log('connecting mqtt client')
        const client = mqtt.connect(host, 9001)

        client.on('error', (err) => {
        console.log('Connection error: ', err)
        client.end()
        })

        client.on('reconnect', () => {
        console.log('Reconnecting...')
        })

        client.on('connect', () => {
        console.log('Client connected:' + clientId)
        client.subscribe('testtopic', { qos: 0 })
        client.publish('testtopic', 'ws connection demo...!', { qos: 0, retain: false })
        })

        client.on('message', (topic, message, packet) => {
        console.log('Received Message: ' + message.toString() + '\nOn topic: ' + topic)
        })

        client.on('close', () => {
        console.log(clientId + ' disconnected')
        })
    </script>
</head>
<body>
    WebSocket client to connect to MQTT server
</body>

</html>